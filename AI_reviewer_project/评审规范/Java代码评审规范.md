# Java代码评审规范

## 1. 代码风格与格式评审

### 1.1 缩进与换行
- [ ] 代码缩进使用4个空格，不使用Tab字符
- [ ] 每行代码长度不超过120个字符
- [ ] 合理使用空行分隔不同逻辑块
- [ ] 左大括号与代码在同一行，右大括号独占一行
- [ ] 二元操作符前后有空格，一元操作符后无空格

### 1.2 导入规范
- [ ] 移除未使用的导入语句
- [ ] 导入包按顺序排列（Java标准库、第三方库、本地包）
- [ ] 使用星号(*)导入时，确保导入的包不超过5个类

### 1.3 注释规范
- [ ] 类和接口有Javadoc注释，包含功能描述、作者和版本信息
- [ ] 方法有Javadoc注释，包含功能描述、参数、返回值和异常信息
- [ ] 复杂逻辑有行内注释，解释设计意图
- [ ] 避免不必要的注释（如重复代码功能的注释）

## 2. 命名规范评审

### 2.1 包命名
- [ ] 包名使用小写字母和点分隔符，如`com.knowledgebase.controller`
- [ ] 避免使用缩写，确保包名的语义清晰

### 2.2 类与接口命名
- [ ] 类名采用驼峰命名法，首字母大写，如`DocumentController`
- [ ] 接口名采用驼峰命名法，首字母大写，如`FAQDocumentRepository`
- [ ] 抽象类名以`Abstract`为前缀，如`AbstractBaseService`
- [ ] 异常类名以`Exception`为后缀，如`KnowledgeBaseException`

### 2.3 方法与变量命名
- [ ] 方法名采用驼峰命名法，首字母小写，如`getAllDocuments()`
- [ ] 变量名采用驼峰命名法，首字母小写，如`faqDocumentService`
- [ ] 常量名全部大写，单词间用下划线分隔，如`MAX_RETRY_COUNT`
- [ ] 临时变量名简洁明了，如`i`、`j`（用于循环）

## 3. 架构与设计评审

### 3.1 分层架构
- [ ] 代码是否遵循MVC分层架构（Controller、Service、Repository、Model）
- [ ] 各层职责是否清晰，是否存在跨层调用
- [ ] 是否遵循单一职责原则（SRP）

### 3.2 依赖管理
- [ ] 是否使用依赖注入（@Autowired）而非硬编码依赖
- [ ] 依赖关系是否合理，是否存在循环依赖
- [ ] 是否针对接口编程而非具体实现

### 3.3 异常处理
- [ ] 是否使用自定义异常类而非通用异常
- [ ] 异常处理是否合理，避免空catch块
- [ ] 异常信息是否清晰，包含足够的诊断信息
- [ ] 是否使用全局异常处理器统一处理异常

### 3.4 事务管理
- [ ] 是否在服务层明确事务边界（@Transactional）
- [ ] 事务传播行为是否设置合理
- [ ] 是否指定事务回滚条件

## 4. 安全与性能评审

### 4.1 安全规范
- [ ] 是否存在SQL注入风险（使用参数化查询）
- [ ] 是否存在XSS攻击风险（输入验证和输出编码）
- [ ] CORS配置是否安全（避免使用通配符*）
- [ ] 敏感数据是否加密存储
- [ ] API是否有适当的认证和授权机制

### 4.2 性能优化
- [ ] 是否存在性能瓶颈（如循环嵌套过深）
- [ ] 是否合理使用缓存减少数据库查询
- [ ] 是否使用批量操作减少网络请求
- [ ] 是否避免在循环中创建对象
- [ ] 数据库查询是否优化（索引使用、避免全表扫描）

### 4.3 日志管理
- [ ] 是否使用SLF4J+Logback等标准日志框架
- [ ] 日志级别是否合理（DEBUG、INFO、WARN、ERROR）
- [ ] 日志内容是否包含足够的诊断信息
- [ ] 是否避免在生产环境输出敏感信息

## 5. 测试与质量评审

### 5.1 测试覆盖
- [ ] 是否有单元测试覆盖核心业务逻辑
- [ ] 测试用例是否覆盖正常、异常和边界情况
- [ ] 是否有集成测试验证系统各组件协同工作
- [ ] 测试代码是否符合测试规范

### 5.2 代码质量
- [ ] 是否存在重复代码（DRY原则）
- [ ] 是否存在过长方法（建议不超过50行）
- [ ] 是否存在过大类（建议不超过500行）
- [ ] 是否使用合适的设计模式

## 6. 文档与注释评审

### 6.1 文档完整性
- [ ] 是否有类和方法的Javadoc注释
- [ ] 复杂算法是否有详细注释
- [ ] 关键决策是否有注释说明原因

### 6.2 注释质量
- [ ] 注释是否准确反映代码功能
- [ ] 注释是否使用清晰、简洁的语言
- [ ] 是否避免过时的注释

## 7. 代码评审流程与最佳实践

### 7.1 评审流程
1. **提交评审前检查**
   - 代码是否通过编译
   - 代码是否通过单元测试
   - 代码是否通过静态代码分析（如SonarQube）

2. **评审中注意事项**
   - 关注代码的可读性和可维护性
   - 关注代码的正确性和安全性
   - 提出具体的改进建议，而非简单的批评
   - 尊重代码作者的劳动成果

3. **评审后处理**
   - 及时修复评审中发现的问题
   - 对争议点进行讨论和达成共识
   - 更新相关文档

### 7.2 最佳实践
- 每次评审的代码量不宜过大（建议不超过500行）
- 评审时间不宜过长（建议不超过30分钟）
- 多人参与评审，交叉检查
- 使用代码评审工具（如GitHub Pull Request、GitLab Merge Request）
- 定期回顾和优化评审流程

---

## 8. 关键检查清单

### 8.1 必须修复的问题
- 语法错误和编译错误
- 安全漏洞（如SQL注入、XSS攻击）
- 内存泄漏和性能瓶颈
- 逻辑错误和功能缺陷

### 8.2 建议修复的问题
- 代码风格不一致
- 命名不规范
- 注释不完整
- 重复代码
- 设计模式使用不当

### 8.3 可选优化的问题
- 代码可读性提升
- 性能微优化
- 代码结构调整

---

## 9. 评审标准

| 问题类型 | 严重程度 | 处理方式 |
|---------|---------|---------|
| 安全漏洞 | 高 | 必须修复，否则拒绝合并 |
| 功能缺陷 | 高 | 必须修复，否则拒绝合并 |
| 性能瓶颈 | 中 | 建议修复，否则影响系统性能 |
| 代码风格 | 低 | 建议修复，保持代码一致性 |
| 注释问题 | 低 | 建议修复，提高代码可维护性 |
